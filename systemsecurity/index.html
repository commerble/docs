<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="セキュリティ対策 #   システムで対応する事(セキュアなインフラ、セキュアなプログラミング)と運用で対応することに分かれる。 運用で対応する事には、PCI DSS のようなカード情報を扱う企業の条件についてふれる。 その他のトピックとして「カード情報の非保持、非通過」というトレンドについても触れる。 他に利用している外部サービス(特にクラウド)のアカウントを厳重に管理していく必要がある。  セキュアなプログラミングで対応する #   下記については、利用しているECサイトでどのような対策がされているか、網羅して頂きたい。 把握する方法としては、そもそも利用しているテクノロジーで防がれているもの、利用しているインフラで防がれているもの、 個別に対応を入れることによって防がれているものがある。 また攻撃手法は年々色々な方法が増えているので、定期的にキャッチアップしていきたい。 IPAの「 安全なウェブサイトの作り方」は必読。  上記抜粋になるが、主要な点を列挙する #    SQL インジェクション
  クロスサイト・スクリプティング
  CSRF（クロスサイト・リクエスト・フォージェリ）
  セッション管理の不備
  OS コマンド・インジェクション
  パス名パラメータの未チェック／ディレクトリ・トラバーサル
  HTTP ヘッダ・インジェクション
  メールヘッダ・インジェクション
  クリックジャッキング
  バッファオーバーフロー
  アクセス制御や認可制御の欠落
  ウェブサイトの安全性向上のための取り組み
  ウェブサーバに関する対策
  DNS に関する対策"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="セキュリティ対策"><meta property="og:description" content="セキュリティ対策 #   システムで対応する事(セキュアなインフラ、セキュアなプログラミング)と運用で対応することに分かれる。 運用で対応する事には、PCI DSS のようなカード情報を扱う企業の条件についてふれる。 その他のトピックとして「カード情報の非保持、非通過」というトレンドについても触れる。 他に利用している外部サービス(特にクラウド)のアカウントを厳重に管理していく必要がある。  セキュアなプログラミングで対応する #   下記については、利用しているECサイトでどのような対策がされているか、網羅して頂きたい。 把握する方法としては、そもそも利用しているテクノロジーで防がれているもの、利用しているインフラで防がれているもの、 個別に対応を入れることによって防がれているものがある。 また攻撃手法は年々色々な方法が増えているので、定期的にキャッチアップしていきたい。 IPAの「 安全なウェブサイトの作り方」は必読。  上記抜粋になるが、主要な点を列挙する #    SQL インジェクション
  クロスサイト・スクリプティング
  CSRF（クロスサイト・リクエスト・フォージェリ）
  セッション管理の不備
  OS コマンド・インジェクション
  パス名パラメータの未チェック／ディレクトリ・トラバーサル
  HTTP ヘッダ・インジェクション
  メールヘッダ・インジェクション
  クリックジャッキング
  バッファオーバーフロー
  アクセス制御や認可制御の欠落
  ウェブサイトの安全性向上のための取り組み
  ウェブサーバに関する対策
  DNS に関する対策"><meta property="og:type" content="article"><meta property="og:url" content="/systemsecurity/"><meta property="article:published_time" content="2020-08-07T00:00:00+00:00"><meta property="article:modified_time" content="2020-08-11T08:35:07+09:00"><title>セキュリティ対策 | ecspec sample</title><link rel=manifest href=../manifest.json><link rel=icon href=../favicon.png type=image/x-icon><link rel=stylesheet href=../book.min.6cd8553a6854f4812343f0f0c8baca31271e686434f381fbe3c7226f66639176.css integrity="sha256-bNhVOmhU9IEjQ/DwyLrKMSceaGQ084H748cib2ZjkXY="><script defer src=../ja.search.min.2b7a32b72abc1072255206052cb00f49d7451b431658cb8848879b41b7ecfecc.js integrity="sha256-K3oytyq8EHIlUgYFLLAPSddFG0MWWMuISIebQbfs/sw="></script><script defer src=../sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js integrity="sha256-dKi7B/C+6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-XXXXXXXXX-X','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=../><span>ecspec sample</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=検索 aria-label=検索 maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=../ec/>EC</a></li><li><a href=../ecbusiness/>ECの多様な事業形態</a></li><li><a href=../systemload/>システム負荷対策</a></li><li><a href=../systemsecurity/ class=active>セキュリティ対策</a></li><li><a href=../promotion/>プロモーション</a></li><li><a href=../unauthorizeduse/>不正利用対策</a></li><li><a href=../wms/>倉庫(WMS)連携</a></li><li><a href=../orderstatus/>受注ステータス</a></li><li><a href=../product/>商品</a></li><li><a href=../stock/>在庫</a></li><li><a href=../federation/>基幹連携</a></li><li><a href=../payment/>支払方法</a></li><li><a href=../order/>注文</a></li><li><a href=../customer/>顧客</a></li></ul><ul><li><a href=https://github.com/commerble/docs target=_blank rel=noopener>Github</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=../svg/menu.svg class=book-icon alt=Menu></label>
<strong>セキュリティ対策</strong>
<label for=toc-control><img src=../svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#セキュリティ対策>セキュリティ対策</a><ul><li><a href=#セキュアなプログラミングで対応する>セキュアなプログラミングで対応する</a><ul><li><a href=#上記抜粋になるが主要な点を列挙する>上記抜粋になるが、主要な点を列挙する</a></li></ul></li><li><a href=#アプリケーションを構築するフレームワークで対応すべきこと>アプリケーションを構築するフレームワークで対応すべきこと</a><ul><li><a href=#sqlインジェクション>SQLインジェクション</a></li><li><a href=#クロスサイトスクリプティング>クロスサイトスクリプティング</a></li></ul></li><li><a href=#アプリケーションを構築するインフラで対応すべきこと>アプリケーションを構築するインフラで対応すべきこと</a><ul><li><a href=#cookieにsecure属性を付与しhttpでcookieが通信されないようにする>Cookieにsecure属性を付与し、HTTPでCookieが通信されないようにする</a></li><li><a href=#cookieにhttponly属性を加え-trace-メソッドを無効化する>CookieにHttpOnly属性を加え、 TRACE メソッドを無効化する。</a></li></ul></li><li><a href=#カード情報の非保持非通過>カード情報の非保持、非通過</a></li><li><a href=#pci-dss-の遵守要件を確認する>PCI DSS の遵守要件を確認する</a></li><li><a href=#アカウント管理>アカウント管理</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=セキュリティ対策>セキュリティ対策
<a class=anchor href=#%e3%82%bb%e3%82%ad%e3%83%a5%e3%83%aa%e3%83%86%e3%82%a3%e5%af%be%e7%ad%96>#</a></h1><ul><li>システムで対応する事(セキュアなインフラ、セキュアなプログラミング)と運用で対応することに分かれる。</li><li>運用で対応する事には、PCI DSS のようなカード情報を扱う企業の条件についてふれる。</li><li>その他のトピックとして「カード情報の非保持、非通過」というトレンドについても触れる。</li><li>他に利用している外部サービス(特にクラウド)のアカウントを厳重に管理していく必要がある。</li></ul><h2 id=セキュアなプログラミングで対応する>セキュアなプログラミングで対応する
<a class=anchor href=#%e3%82%bb%e3%82%ad%e3%83%a5%e3%82%a2%e3%81%aa%e3%83%97%e3%83%ad%e3%82%b0%e3%83%a9%e3%83%9f%e3%83%b3%e3%82%b0%e3%81%a7%e5%af%be%e5%bf%9c%e3%81%99%e3%82%8b>#</a></h2><ul><li>下記については、利用しているECサイトでどのような対策がされているか、網羅して頂きたい。</li><li>把握する方法としては、そもそも利用しているテクノロジーで防がれているもの、利用しているインフラで防がれているもの、
個別に対応を入れることによって防がれているものがある。</li><li>また攻撃手法は年々色々な方法が増えているので、定期的にキャッチアップしていきたい。</li><li>IPAの「
<a href=https://www.ipa.go.jp/security/vuln/websecurity.html>安全なウェブサイトの作り方</a>」は必読。</li></ul><h3 id=上記抜粋になるが主要な点を列挙する>上記抜粋になるが、主要な点を列挙する
<a class=anchor href=#%e4%b8%8a%e8%a8%98%e6%8a%9c%e7%b2%8b%e3%81%ab%e3%81%aa%e3%82%8b%e3%81%8c%e4%b8%bb%e8%a6%81%e3%81%aa%e7%82%b9%e3%82%92%e5%88%97%e6%8c%99%e3%81%99%e3%82%8b>#</a></h3><ul><li><p>SQL インジェクション</p></li><li><p>クロスサイト・スクリプティング</p></li><li><p>CSRF（クロスサイト・リクエスト・フォージェリ）</p></li><li><p>セッション管理の不備</p></li><li><p>OS コマンド・インジェクション</p></li><li><p>パス名パラメータの未チェック／ディレクトリ・トラバーサル</p></li><li><p>HTTP ヘッダ・インジェクション</p></li><li><p>メールヘッダ・インジェクション</p></li><li><p>クリックジャッキング</p></li><li><p>バッファオーバーフロー</p></li><li><p>アクセス制御や認可制御の欠落</p></li><li><p>ウェブサイトの安全性向上のための取り組み</p></li><li><p>ウェブサーバに関する対策</p></li><li><p>DNS に関する対策</p></li><li><p>ネットワーク盗聴への対策</p></li><li><p>フィッシング詐欺を助長しないための対策</p></li><li><p>パスワードに関する対策</p></li><li><p>WAF によるウェブアプリケーションの保護</p></li></ul><h2 id=アプリケーションを構築するフレームワークで対応すべきこと>アプリケーションを構築するフレームワークで対応すべきこと
<a class=anchor href=#%e3%82%a2%e3%83%97%e3%83%aa%e3%82%b1%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%b3%e3%82%92%e6%a7%8b%e7%af%89%e3%81%99%e3%82%8b%e3%83%95%e3%83%ac%e3%83%bc%e3%83%a0%e3%83%af%e3%83%bc%e3%82%af%e3%81%a7%e5%af%be%e5%bf%9c%e3%81%99%e3%81%b9%e3%81%8d%e3%81%93%e3%81%a8>#</a></h2><ul><li><p>下記の攻撃手法は、アプリケーションを構築するフレームワークで対応されていることが望ましい。</p></li><li><p>プログラミングで一行一行対応すると、人的なミスで脆弱性を内包してしまう可能性がある。</p></li><li><p>フレームワーク上できない場合は、該当箇所の重点的なレビューが必要になる。</p></li><li><p>フレームワークで対応すべきという観点では、昨年話題になった何件かの情報漏洩はApache Struts2 のフレームワーク、そのアップデート不足に起因するものがあった。フレームワークとして、そもそも攻撃手法を封じているものを使うほうが安全性が高い。</p></li><li><p>古いソフト、古いパッケージやOSS、プラグインを利用したままで、アップデートしていないケースで発生しているケースが多い。</p></li><li><p>EC-CUBEやWordPressはプラグインを含めて、この脆弱性が豊富で常に最新へのアップデートが必要。</p></li><li><p>イントラネットは外部侵入できなくなっているので、アップデートは不要という担当者もいるかもしれないが、昨今ではそのような考え方は企業のリスクを高めるものである。利用している環境のアップデートは本日では義務といえる。</p></li></ul><h3 id=sqlインジェクション>SQLインジェクション
<a class=anchor href=#sql%e3%82%a4%e3%83%b3%e3%82%b8%e3%82%a7%e3%82%af%e3%82%b7%e3%83%a7%e3%83%b3>#</a></h3><ul><li>SQLインジェクションについてはURLに含まれるパラメーターを通じて、不正なSQL(データベースへのアクセスを)を行うことを可能としてしまう。</li><li>脆弱性があるシステムだと、URLに　https://ec.com/login?1=1 などのパラメータを投入すると、不正な情報が見えたり、他人でログインできたりする。</li></ul><h3 id=クロスサイトスクリプティング>クロスサイトスクリプティング
<a class=anchor href=#%e3%82%af%e3%83%ad%e3%82%b9%e3%82%b5%e3%82%a4%e3%83%88%e3%82%b9%e3%82%af%e3%83%aa%e3%83%97%e3%83%86%e3%82%a3%e3%83%b3%e3%82%b0>#</a></h3><ul><li>URLや投稿内容にJavaScriptを埋め込み、不正な情報通信や不正な挙動を発生させる。</li><li>脆弱性があるシステムだと悪意のあるユーザーが入力したJavaScriptが動作することによってサイトの情報が不正に変わったり、不正なサイトに飛ばされたり、Cookieを盗まれ、ログインされてしまう等が発生する。</li><li>システムからHTMLを出力する際に内容を無害化することにより防ぐことが出来る。</li></ul><h2 id=アプリケーションを構築するインフラで対応すべきこと>アプリケーションを構築するインフラで対応すべきこと
<a class=anchor href=#%e3%82%a2%e3%83%97%e3%83%aa%e3%82%b1%e3%83%bc%e3%82%b7%e3%83%a7%e3%83%b3%e3%82%92%e6%a7%8b%e7%af%89%e3%81%99%e3%82%8b%e3%82%a4%e3%83%b3%e3%83%95%e3%83%a9%e3%81%a7%e5%af%be%e5%bf%9c%e3%81%99%e3%81%b9%e3%81%8d%e3%81%93%e3%81%a8>#</a></h2><h3 id=cookieにsecure属性を付与しhttpでcookieが通信されないようにする>Cookieにsecure属性を付与し、HTTPでCookieが通信されないようにする
<a class=anchor href=#cookie%e3%81%absecure%e5%b1%9e%e6%80%a7%e3%82%92%e4%bb%98%e4%b8%8e%e3%81%97http%e3%81%a7cookie%e3%81%8c%e9%80%9a%e4%bf%a1%e3%81%95%e3%82%8c%e3%81%aa%e3%81%84%e3%82%88%e3%81%86%e3%81%ab%e3%81%99%e3%82%8b>#</a></h3><ul><li>重要なCookieはHTTPSのみでCookieが送信されるようにSecure属性をつける。</li><li>HTTPで送信することによって、セッションIDなど重要な情報が漏洩する可能性があるのでHTTPSでのみ通信する。</li></ul><h3 id=cookieにhttponly属性を加え-trace-メソッドを無効化する>CookieにHttpOnly属性を加え、 TRACE メソッドを無効化する。
<a class=anchor href=#cookie%e3%81%abhttponly%e5%b1%9e%e6%80%a7%e3%82%92%e5%8a%a0%e3%81%88-trace-%e3%83%a1%e3%82%bd%e3%83%83%e3%83%89%e3%82%92%e7%84%a1%e5%8a%b9%e5%8c%96%e3%81%99%e3%82%8b>#</a></h3><ul><li>HttpOnlyが設定されたCookieは、HTML内のスクリプトからのアクセスが禁止されます。ウェブサイトにクロスサイト・スクリプティングの脆弱性が存在する場合等で、Cookieを盗まれるのを防ぐことが出来る。</li></ul><h2 id=カード情報の非保持非通過>カード情報の非保持、非通過
<a class=anchor href=#%e3%82%ab%e3%83%bc%e3%83%89%e6%83%85%e5%a0%b1%e3%81%ae%e9%9d%9e%e4%bf%9d%e6%8c%81%e9%9d%9e%e9%80%9a%e9%81%8e>#</a></h2><ul><li>カード情報を非保持、自社EC上のサーバーを非通過とすることが2018年5月より厳格に求められている。</li><li>もしくは、 PCI DSSに準拠することが求められる。(後述)</li></ul><h2 id=pci-dss-の遵守要件を確認する>PCI DSS の遵守要件を確認する
<a class=anchor href=#pci-dss-%e3%81%ae%e9%81%b5%e5%ae%88%e8%a6%81%e4%bb%b6%e3%82%92%e7%a2%ba%e8%aa%8d%e3%81%99%e3%82%8b>#</a></h2><ul><li>遵守要件自体は参考になるものなので、一読する事を推奨する。</li><li></li></ul><h2 id=アカウント管理>アカウント管理
<a class=anchor href=#%e3%82%a2%e3%82%ab%e3%82%a6%e3%83%b3%e3%83%88%e7%ae%a1%e7%90%86>#</a></h2><ul><li>クラウドのアカウント管理は多要素認証を利用する。</li><li>ECサイトの管理画面などはIP制限や、証明書による制御を検討する。</li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/commerble/docs/commit/e497892efe0897e122617fb8179a72343c8e0227 title="最終更新者 nabehiro | August 10, 2020" target=_blank rel=noopener><img src=../svg/calendar.svg class=book-icon alt=Calendar>
<span>August 10, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/commerble/docs/edit/master//systemsecurity.md target=_blank rel=noopener><img src=../svg/edit.svg class=book-icon alt=Edit>
<span>このページを編集する</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#セキュリティ対策>セキュリティ対策</a><ul><li><a href=#セキュアなプログラミングで対応する>セキュアなプログラミングで対応する</a><ul><li><a href=#上記抜粋になるが主要な点を列挙する>上記抜粋になるが、主要な点を列挙する</a></li></ul></li><li><a href=#アプリケーションを構築するフレームワークで対応すべきこと>アプリケーションを構築するフレームワークで対応すべきこと</a><ul><li><a href=#sqlインジェクション>SQLインジェクション</a></li><li><a href=#クロスサイトスクリプティング>クロスサイトスクリプティング</a></li></ul></li><li><a href=#アプリケーションを構築するインフラで対応すべきこと>アプリケーションを構築するインフラで対応すべきこと</a><ul><li><a href=#cookieにsecure属性を付与しhttpでcookieが通信されないようにする>Cookieにsecure属性を付与し、HTTPでCookieが通信されないようにする</a></li><li><a href=#cookieにhttponly属性を加え-trace-メソッドを無効化する>CookieにHttpOnly属性を加え、 TRACE メソッドを無効化する。</a></li></ul></li><li><a href=#カード情報の非保持非通過>カード情報の非保持、非通過</a></li><li><a href=#pci-dss-の遵守要件を確認する>PCI DSS の遵守要件を確認する</a></li><li><a href=#アカウント管理>アカウント管理</a></li></ul></li></ul></nav></aside></main></body></html>