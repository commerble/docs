---
title: "リスト管理"
weight: 30
description: 
---

リストとは[CMSデータ](../../../../development/data/cms)として定義したデータのことです。
リスト管理ページでは、このリストの管理を行います。  
[CMSデータ](../../../../development/data/cms)はテナントのシステム要件に応じて自由に設計できるデータです。

## リスト一覧（メニュー）
定義済のリストの一覧がメニューに表示されます。  
下記の画像はサンプルECサイトのリスト一覧になります。テナントによりリスト一覧は異なります。  

![リスト一覧](list-of-list.png)

## CMSデータ一覧
リスト一覧より管理するCMSデータを選択するとCMSデータ一覧が表示されます。

![一覧](list.png)

**新規作成**ボタン押下すると新規にデータを登録できます。

**リサイクル**ボタン押下すると過去に削除したデータを復元する画面が表示されます。
誤ってデータを削除してしまった場合などに利用します。設定によりますが、復元できる削除データは直近200件のデータのみとなります。

**一括アップロード**ボタンを押下するとデータを一括アップロードする画面が表示されます。詳細は[一括アップロード](#一括アップロードcsv)をご参照ください。

**一括ダウンロード**ボタンを押下すると、データをCSV形式でダウンロードできます。
こちらでダウンロードしたCSVは[一括アップロード](#一括アップロードcsv)するCSVと同様の形式になります。
ダウンロードデータをフィルターする場合は、一覧で条件を指定してフィルターしてから**一括ダウンロード**を行ってください。

## CMSデータ詳細
一覧で選択したデータが**一覧の下部**に表示されます。

![詳細](detail.png)

**編集**ボタンを押下すると表示しているデータを編集できます。

**削除**ボタンを押下すると表示しているデータを削除します。

**新規作成**ボタンを押下するとデータを新規登録できます。

**連鎖削除**ボタンを押下すると表示しているデータを削除する際に、このデータと関連した他のCMSデータを一緒に削除します。

**拡張機能:コピー**リンクを押下すると表示しているデータを元に、データを新規登録できます。

## 一括アップロード（CSV）
CMSデータをCSVをアップロードして一括登録します。
ここでは登録するデータを、CSV形式のファイルでアップロードします。  
Blob(Binary Large Object)を含むデータを一括登録する場合は、[一括アップロード（Zip圧縮）](#一括アップロードzip圧縮)をご参照ください。

以下は**一括アップロード**ボタンを押下したときに表示されるアップロード画面です。  
※以下はバナーのリストデータを開いた時で、他のリストデータの場合は `ColumnName`, `ViewName` の項目が異なります。

![アップロード](upload.png)

### 一括アップロードの手順
1. **template download**リンクより、一括アップロード用のCSVテンプレートファイルをダウンロードします。
2. CSVファイルを作成します。
3. **Choose File**ボタンからアップロードするファイルを選択、**アップロード**ボタンよりファイルをアップロードします。*この段階ではまだ登録はされません。*
4. アップロードされたCSVのデータに問題がある場合エラーが表示され、**取り込み**ボタンを押すことが出来なくなります。**そしてエラーのある行は空白の行として表示されます。**
5. エラーがない状態で、**取り込み**ボタンを押下してデータを登録します。

### CSVファイルのルール
アップロードするCSVファイルにはいくつかルールがあります。

**ヘッダー列は必ず３行必要**  
1行目はCMSデータのフィールドの表示名、2行目は型、3行目は列名になります。  
**template download**リンクよりダウンロードできるCSVテンプレートファイルには上記3行が含まれています。

![CSVヘッダー](csv.png)

**フィールドの型**  
CMSデータのフィールドの型は、**template download**リンクよりダウンロードできるCSVテンプレートファイルの2行目に記載されています。  
入力必須のフィールドの場合、`(*)` が型の後に表示されます。`Int32(*)`は、入力必須の整数の型を表します。  

| 型       | 説明   | 設定値の例                                                                                      |
|----------|--------|-------------------------------------------------------------------------------------------------|
| Boolean  | 真偽値 | `True`、`False`                                                                                     |
| Int32    | 整数   | `100`、`-100`                                                                                       |
| Int64    | 長整数 | `10000`、`-10000`                                                                                   |
| String   | 文字列 | `いろはにほへと`                                                                                  |
| DateTime | 日時   | `2016/09/20 14:08:02`、`2020/01/01`                                                                 |
| Byte[]   | Blob(バイナリファイル)   | Zip圧縮で一括アップロードをする場合に、Zip圧縮前のディレクトリのBlobファイルのパスを指定する。<br/>`images\hero.png` |


**CSVの列は可変。但し主キーの列は必須**  
CSVファイルに用意する列は必ずしも全てのフィールドを用意する必要はありません。  
必ず必要な列は、データを一意に識別する主キーとなるフィールドです。データを新規登録する場合は、入力必須のフィールドの列も必要です。  
- **主キー**: **IsPrimaryKey** がチェックされている
- **入力必須**: **IsNullable** がチェックされていない

![主キー・入力必須](primary-nullable.png)

**未登録→新規登録。登録済→更新**  
アップロードするCSVデータが、Commerbleに未登録の場合は新規登録されます。Commerbleに登録済の場合は更新されます。

## 一括アップロード（Zip圧縮）
登録するファイルをZip圧縮してアップロードします。  
Zip圧縮アップロードは、リストデータと一緒に画像やCSSなどのファイルを一緒にアップロードする場合に利用します。  

**例：バナー画像を２つ（`top-banner.png`, `side-banner.png`）アップロードする場合**
1. バナーのリスト管理画面で、CSVファイルのテンプレートをダウンロードします。テンプレートダウンロードは、一括アップロード画面の **template download** リンクから出来ます。
2. ダウンロードしたCSVファイル名を `2020banner.csv` に変更します。CSVファイル名は任意ですが説明の都合上 `2020banner.csv` としています。
3. CSVファイルと同じ名前の空ディレクトリ、`2020banner` を作成します。ディレクトリ名はCSVファイル名と同じにする必要があります。
4. 作成したディレクトリ直下に、CSVファイルを配置します。
5. 作成したディレクトリ直下に、`top-banner.png`, `side-banner.png` を配置します。
6. CSVファイルを編集し登録するバナーデータの行を追加します。バナーデータの画像の設定は、`Byte[]` 型の列に画像ファイルパスを指定します。
7. 以上でファイルは作成できましたので、作成したディレクトリ、`2020banner` をZip圧縮します。Zip圧縮したファイルはCSVファイル名と同じ `2020banner.zip` としてください。
8. Zip圧縮したファイル、`2020banner.zip` を、一括アップロード画面から [アップロード](#一括アップロードの手順)します。

{{% alert title="アップロードがうまくいかない場合" color="warning" %}}
画像ファイルパスに誤りがあるなど、圧縮ファイルのディレクトリ構成に問題がある場合はアップロード中にエラーとなり登録できません。  
うまくいかない場合は以下のことを確認してみてください。  
- CSVファイルは存在するか。
- 画像ファイルは存在するか。
- 圧縮ファイル名、ディレクトリ名、CSVファイル名は同じか。
{{% /alert %}}



**2020banner.zip の構成**

![zip例](zip-example.png)

**2020banner.csv**

![zip csv例](zip-csv-example.png)

## WindowsでZip一括アップロード
クライアントマシンがWindowsの場合のアップロード方法を説明します。  
今回作成したZipファイルは、[こちら](SiteFiles.zip)よりダウンロードできます。
この例で一括アップロードするCMSデータは静的ファイルを管理するデータで、以下のスキーマとします。

| 表示名           | カラム名    | 型        | 説明                                  |
|------------------|-------------|-----------|---------------------------------------|
| ファイルタイプ   | FileType    | String(*) | ファイルの種類を保持                  |
| ファイルパス     | FilePath    | String(*) | ECサイトで公開するURLのパスを保持     |
| コンテンツタイプ | ContentType | String    | ECサイトで出力する際のmime-typeを保持 |
| ファイル         | FileBinary  | Byte[]    | Blob(バイナリデータ)を保持            |

今回は画像ファイルを2つ、CSSファイルを2つアップロードする例を説明します。

1. CSVテンプレートファイルをダウンロードします。
2. CSVファイルを編集します。以下は編集したCSVファイル(SiteFiles.csv)です。

![wincsv](win-csv.png)

3. アップロードするファイルを圧縮してアップロードする予定のディレクトリに集めます。  
  *ルートディレクトリの名前はCSVファイルの名前と同じ(SiteFiles)にする必要があります。*

![windir](win-dir.png)

4. ルートディレクトリをZip圧縮します。  
  *Zipファイルの名前はCSVファイルと同じ名前(SiteFiles)にする必要があります。*

![winzipcontext](win-zip-context.png)

![winzipfile](win-zip-file.png)

5. Zipファイル(SiteFiles.zip)をアップロードします。以下はアップロード後の画面です。

![zipuploaded](zip-uploaded.png)

6. **取り込み**ボタンを押下してデータを登録します。

![zipregistered](zip-registered.png)

## macOSでZip一括アップロード
クライアントマシンがmacOSの場合のアップロード方法を説明します。  
今回作成したZipファイルは、[こちら](SiteFiles.zip)よりダウンロードできます。
この例で一括アップロードするCMSデータは静的ファイルを管理するデータで、以下のスキーマとします。

| 表示名           | カラム名    | 型        | 説明                                  |
|------------------|-------------|-----------|---------------------------------------|
| ファイルタイプ   | FileType    | String(*) | ファイルの種類を保持                  |
| ファイルパス     | FilePath    | String(*) | ECサイトで公開するURLのパスを保持     |
| コンテンツタイプ | ContentType | String    | ECサイトで出力する際のmime-typeを保持 |
| ファイル         | FileBinary  | Byte[]    | Blob(バイナリデータ)を保持            |

今回は画像ファイルを2つ、CSSファイルを1つアップロードする例を説明します。

1. CSVテンプレートファイルをダウンロードします。
2. CSVファイルを編集します。以下は編集したCSVファイル(SiteFiles.csv)です。

![maccsv](mac-csv.png)

3. アップロードするファイルを圧縮してアップロードする予定のディレクトリに集めます。  
  *ルートディレクトリの名前はCSVファイルの名前と同じ(SiteFiles)にする必要があります。*

![macdir](mac-dir.png)

4. ルートディレクトリをZip圧縮します。  
  *Zipファイルの名前はCSVファイルと同じ名前(SiteFiles)にする必要があります。*

  ![maczipcontext](mac-zip-context.png)

![maczipfile](mac-zip-file.png)

5. Zipファイル(SiteFiles.zip)をアップロードします。以下はアップロード後の画面です。

![zipuploaded](zip-uploaded.png)

6. **取り込み**ボタンを押下してデータを登録します。

![zipregistered](zip-registered.png)
























